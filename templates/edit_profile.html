<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Settings - Secret Bay</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
  <style>
    :root {
      --primary-color: #1e5a8e;
      --ocean-blue: #006994;
      --accent-color: #FF6B35;
      --secondary-color: #f0f8ff;
    }
    .settings-card {
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .settings-header {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--ocean-blue) 100%);
      color: white;
      padding: 30px;
      border-radius: 10px 10px 0 0;
    }
    .section-title {
      color: #667eea;
      font-weight: 600;
      margin-top: 30px;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e9ecef;
    }

    /* Mobile Responsive Styles */
    .form-control,
    .form-select,
    .btn {
      min-height: 44px;
    }

    @media (max-width: 768px) {
      .settings-header {
        padding: 20px;
      }

      .settings-header h1 {
        font-size: 1.75rem;
      }

      .settings-header svg {
        width: 30px;
        height: 30px;
      }
    }

    @media (max-width: 576px) {
      .container.my-5 {
        margin-top: 1rem !important;
        margin-bottom: 1rem !important;
      }

      .card-body.p-4 {
        padding: 1rem !important;
      }

      .settings-header {
        padding: 15px;
      }

      .settings-header h1 {
        font-size: 1.5rem;
      }

      .btn {
        width: 100%;
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body>
  {% include 'navbar.html' %}
  
  <div class="container my-5">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="settings-card">
          <div class="settings-header">
            <h1 class="mb-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-gear-fill me-2" viewBox="0 0 16 16">
                <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
              </svg>
              Account Settings
            </h1>
            <p class="mb-0">Manage your profile and account preferences</p>
          </div>
          
          <div class="card-body p-4">
            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                {% for category, message in messages %}
                  <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
                {% endfor %}
              {% endif %}
            {% endwith %}

            <form method="post" action="{{ url_for('update_settings') }}">
              <!-- Account Information -->
              <h5 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-badge me-2" viewBox="0 0 16 16">
                  <path d="M6.5 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1h-3zM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                  <path d="M4.5 0A2.5 2.5 0 0 0 2 2.5V14a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2.5A2.5 2.5 0 0 0 11.5 0h-7zM3 2.5A1.5 1.5 0 0 1 4.5 1h7A1.5 1.5 0 0 1 13 2.5v10.795a4.2 4.2 0 0 0-.776-.492C11.392 12.387 10.063 12 8 12s-3.392.387-4.224.803a4.2 4.2 0 0 0-.776.492V2.5z"/>
                </svg>
                Account Information
              </h5>
              
              <div class="mb-3">
                <label class="form-label fw-bold">Username</label>
                <input type="text" class="form-control" value="{{ user['username'] }}" disabled>
                <small class="text-muted">Username cannot be changed</small>
              </div>

              <div class="mb-3">
                <label class="form-label fw-bold">Email</label>
                <input type="email" class="form-control" value="{{ user['email'] }}" disabled>
                <small class="text-muted">Email cannot be changed</small>
              </div>

              <!-- Password Change Section -->
              <h5 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-key me-2" viewBox="0 0 16 16">
                  <path d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z"/>
                  <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                </svg>
                Change Password
              </h5>

              <div class="alert alert-info">
                <small><strong>Password Requirements:</strong> At least 8 characters including uppercase, lowercase, a number, and a symbol.</small>
              </div>

              <div class="mb-3">
                <label for="current_password" class="form-label fw-bold">Current Password</label>
                <input type="password" class="form-control" id="current_password" name="current_password" 
                       placeholder="Enter your current password">
                <small class="text-muted">Required to change password</small>
              </div>

              <div class="mb-3">
                <label for="new_password" class="form-label fw-bold">New Password</label>
                <input type="password" class="form-control" id="new_password" name="new_password" 
                       placeholder="Enter new password">
              </div>

              <div class="mb-3">
                <label for="confirm_password" class="form-label fw-bold">Confirm New Password</label>
                <input type="password" class="form-control" id="confirm_password" name="confirm_password" 
                       placeholder="Confirm new password">
              </div>

              <!-- Seller Information -->
              {% if user['is_seller'] %}
              <h5 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-shop me-2" viewBox="0 0 16 16">
                  <path d="M2.97 1.35A1 1 0 0 1 3.73 1h8.54a1 1 0 0 1 .76.35l2.609 3.044A1.5 1.5 0 0 1 16 5.37v.255a2.375 2.375 0 0 1-4.25 1.458A2.371 2.371 0 0 1 9.875 8 2.37 2.37 0 0 1 8 7.083 2.37 2.37 0 0 1 6.125 8a2.37 2.37 0 0 1-1.875-.917A2.375 2.375 0 0 1 0 5.625V5.37a1.5 1.5 0 0 1 .361-.976l2.61-3.045zm1.78 4.275a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 1 0 2.75 0V5.37a.5.5 0 0 0-.12-.325L12.27 2H3.73L1.12 5.045A.5.5 0 0 0 1 5.37v.255a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0zM1.5 8.5A.5.5 0 0 1 2 9v6h1v-5a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v5h6V9a.5.5 0 0 1 1 0v6h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1V9a.5.5 0 0 1 .5-.5zM4 15h3v-5H4v5zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3zm3 0h-2v3h2v-3z"/>
                </svg>
                Seller Profile
              </h5>

              <div class="mb-3">
                <label for="business_name" class="form-label fw-bold">Business Name (Optional)</label>
                <input type="text" class="form-control" id="business_name" name="business_name" 
                       value="{{ user['business_name'] or '' }}" 
                       placeholder="Your Business Name">
                <small class="text-muted">This will be displayed on your listings</small>
              </div>

              <div class="mb-3">
                <label for="seller_description" class="form-label fw-bold">Seller Description (Optional)</label>
                <textarea class="form-control" id="seller_description" name="seller_description" 
                          rows="4" placeholder="Tell buyers about yourself and what you sell...">{{ user['seller_description'] or '' }}</textarea>
                <small class="text-muted">Describe your business or what you sell</small>
              </div>

              <div class="mb-3">
                <label for="profile_picture" class="form-label fw-bold">Profile Picture URL (Optional)</label>
                <input type="text" class="form-control" id="profile_picture" name="profile_picture" 
                       value="{{ user['profile_picture'] or '' }}" 
                       placeholder="https://example.com/image.jpg">
                <small class="text-muted">Enter a URL to your profile picture</small>
              </div>
              {% endif %}

              <!-- Account Type -->
              <h5 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-info-circle me-2" viewBox="0 0 16 16">
                  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                  <path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                </svg>
                Account Type
              </h5>

              <div class="mb-3">
                <div class="alert alert-info">
                  <strong>Account Status:</strong>
                  {% if user['is_seller'] %}
                    <span class="badge bg-success">Seller Account</span>
                  {% else %}
                    <span class="badge bg-secondary">Buyer Account</span>
                  {% endif %}
                  
                  {% if user['is_admin'] %}
                    <span class="badge bg-danger ms-2">Administrator</span>
                  {% endif %}
                </div>
                {% if not user['is_seller'] %}
                  <p class="text-muted mb-0">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb me-1" viewBox="0 0 16 16">
                      <path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6zm6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1z"/>
                    </svg>
                    Want to sell items? Contact support to upgrade to a seller account.
                  </p>
                {% endif %}
              </div>

              <div class="d-grid gap-2 d-md-flex justify-content-md-between mt-4">
                <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left me-1" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
                  </svg>
                  Back to Home
                </a>
                <button type="submit" class="btn btn-primary btn-lg">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-circle me-1" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
                  </svg>
                  Save Changes
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% include 'footer.html' %}
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</body>
<script src="/static/js/theme.js"></script>
</html>
